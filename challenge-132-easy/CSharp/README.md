This solution was developed with LINQPad.